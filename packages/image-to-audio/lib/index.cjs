function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e=/*#__PURE__*/t(require("image-decode"));function n(){return n=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},n.apply(this,arguments)}function a(t,e,n){for(var a=n.length,r=0;r<a;++r)t.setUint8(e+r,n.charCodeAt(r))}var r=/*#__PURE__*/function(){function t(t){this.sampleRate=void 0,this.numChannels=void 0,this.options=void 0,this._dataViews=[],this._numSamples=0,this.options=n({sampleRate:44100,numChannels:1},t),this.sampleRate=this.options.sampleRate,this.numChannels=this.options.numChannels}var e,r,i=t.prototype;return i.encode=function(t){for(var e=t[0].length,n=this.numChannels,a=new DataView(new ArrayBuffer(e*n*2)),r=0,i=0;i<e;++i)for(var s=0;s<n;++s){var o=32767*t[s][i];a.setInt16(r,o<0?Math.max(o,-32768):Math.min(o,32767),!0),r+=2}return this._dataViews.push(a),this._numSamples+=e,a},i.finish=function(t){void 0===t&&(t="audio/wav");var e=this.numChannels*this._numSamples*2,n=new DataView(new ArrayBuffer(44));a(n,0,"RIFF"),n.setUint32(4,36+e,!0),a(n,8,"WAVE"),a(n,12,"fmt "),n.setUint32(16,16,!0),n.setUint16(20,1,!0),n.setUint16(22,this.numChannels,!0),n.setUint32(24,this.sampleRate,!0),n.setUint32(28,4*this.sampleRate,!0),n.setUint16(32,2*this.numChannels,!0),n.setUint16(34,16,!0),a(n,36,"data"),n.setUint32(40,e,!0),this._dataViews.unshift(n);var r=new Blob(this._dataViews,{type:t});return this._dataViews=[],r},i.destory=function(){delete this._dataViews},e=t,(r=[{key:"dataViews",get:function(){return this._dataViews}}])&&function(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,"symbol"==typeof(r=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(a.key))?r:String(r),a)}var r}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function i(t,a){for(var r=e.default(t,a),i=[],s=0;s<r.data.length;)i.push(r.data.slice(s,s+=4));return n({},r,{data:i})}function s(t){for(var e=0,n=765*t.length,a=0;a<t.length;a++){var r=t[a];e+=r[0]+r[1]+r[2]}return 2e4*e/n}function o(t,e){var n,a=[];if(e.encodeData)a=e.encodeData(t);else for(var r=0;r<t.width;r++){for(var i=[],o=0;o<t.height;o++)i.push(t.data[o*t.width+r]);a.push(i)}var u=null!=(n=e.encodeFunc)?n:s;return a.map(function(t){return u(t)})}function u(t,e){for(var n=e.seconds,a=[],r=e.sampleRate*n/t.length,i=n/t.length,s=0;s<t.length;s++)for(var o=~~(t[s]*i)*Math.PI*2,u=0;u<r;u++){var h=Math.sin(u/r*o);a.push(h)}return new Float32Array(a)}function h(t,e){var a=n({sampleRate:44100,bpm:60,beat:1/4},e),s=o(i(t,null==a?void 0:a.mimeType),a),h=u(s,{sampleRate:a.sampleRate,seconds:s.length*a.beat/a.bpm*60}),l=new r({sampleRate:a.sampleRate});return l.encode([h]),l.finish()}exports.AudioEncoder=r,exports.decodeImage=i,exports.default=h,exports.encodeImage2Freqs=o,exports.freqs2AudioData=u,exports.imageToAudio=h;
//# sourceMappingURL=index.cjs.map
