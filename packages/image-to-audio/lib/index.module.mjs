import t from"image-decode";function e(){return e=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},e.apply(this,arguments)}function n(t,e,n){for(var a=n.length,i=0;i<a;++i)t.setUint8(e+i,n.charCodeAt(i))}var a=/*#__PURE__*/function(){function t(t){this.sampleRate=void 0,this.numChannels=void 0,this.options=void 0,this._dataViews=[],this._numSamples=0,this.options=e({sampleRate:44100,numChannels:1},t),this.sampleRate=this.options.sampleRate,this.numChannels=this.options.numChannels}var a,i,r=t.prototype;return r.encode=function(t){for(var e=t[0].length,n=this.numChannels,a=new DataView(new ArrayBuffer(e*n*2)),i=0,r=0;r<e;++r)for(var s=0;s<n;++s){var o=32767*t[s][r];a.setInt16(i,o<0?Math.max(o,-32768):Math.min(o,32767),!0),i+=2}return this._dataViews.push(a),this._numSamples+=e,a},r.finish=function(t){void 0===t&&(t="audio/wav");var e=this.numChannels*this._numSamples*2,a=new DataView(new ArrayBuffer(44));n(a,0,"RIFF"),a.setUint32(4,36+e,!0),n(a,8,"WAVE"),n(a,12,"fmt "),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,this.numChannels,!0),a.setUint32(24,this.sampleRate,!0),a.setUint32(28,4*this.sampleRate,!0),a.setUint16(32,2*this.numChannels,!0),a.setUint16(34,16,!0),n(a,36,"data"),a.setUint32(40,e,!0),this._dataViews.unshift(a);var i=new Blob(this._dataViews,{type:t});return this._dataViews=[],i},r.destory=function(){delete this._dataViews},a=t,(i=[{key:"dataViews",get:function(){return this._dataViews}}])&&function(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,"symbol"==typeof(i=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(a.key))?i:String(i),a)}var i}(a.prototype,i),Object.defineProperty(a,"prototype",{writable:!1}),t}();function i(n,a){for(var i=t(n,a),r=[],s=0;s<i.data.length;)r.push(i.data.slice(s,s+=4));return e({},i,{data:r})}function r(t){for(var e=0,n=765*t.length,a=0;a<t.length;a++){var i=t[a];e+=i[0]+i[1]+i[2]}return 2e4*e/n}function s(t,e){var n,a=[];if(e.encodeData)a=e.encodeData(t);else for(var i=0;i<t.width;i++){for(var s=[],o=0;o<t.height;o++)s.push(t.data[o*t.width+i]);a.push(s)}var u=null!=(n=e.encodeFunc)?n:r;return a.map(function(t){return u(t)})}function o(t,e){for(var n=e.seconds,a=[],i=e.sampleRate*n/t.length,r=n/t.length,s=0;s<t.length;s++)for(var o=~~(t[s]*r)*Math.PI*2,u=0;u<i;u++){var h=Math.sin(u/i*o);a.push(h)}return new Float32Array(a)}function u(t,n){var r=e({sampleRate:44100,bpm:60,beat:1/4},n),u=s(i(t,null==r?void 0:r.mimeType),r),h=o(u,{sampleRate:r.sampleRate,seconds:u.length*r.beat/r.bpm*60}),l=new a({sampleRate:r.sampleRate});return l.encode([h]),l.finish()}export{a as AudioEncoder,i as decodeImage,u as default,s as encodeImage2Freqs,o as freqs2AudioData,u as imageToAudio};
//# sourceMappingURL=index.module.mjs.map
